# =============================================================================
# Dynamic PERFORMANCE+ Configuration File
# =============================================================================
# This configuration file allows fine-tuning of server optimization features.
# Each section controls a specific aspect of performance enhancement.
# Changes take effect after /dp reload or server restart.
# =============================================================================

# -----------------------------------------------------------------------------
# CHUNK MANAGEMENT OPTIMIZATIONS
# -----------------------------------------------------------------------------
chunks:
  # Enable asynchronous chunk loading to reduce main thread lag
  async_loading: true

  # Maximum distance (in blocks) for chunk unloading from players
  unload_distance: 100

  # Enable preloading of chunks around players for smoother movement
  preload_enabled: true

  # Radius (in chunks) for preloading around players
  preload_radius: 3

  # Maximum chunks to keep loaded per player (0 = unlimited)
  max_loaded_chunks: 0

  # Interval (in ticks) for chunk management checks
  management_interval: 600  # 30 seconds

# -----------------------------------------------------------------------------
# ENTITY AND MOB OPTIMIZATIONS
# -----------------------------------------------------------------------------
entities:
  # Distance (in blocks) beyond which entities are culled from processing
  cull_distance: 50

  # Enable AI throttling to reduce entity processing load
  ai_throttle: true

  # Maximum entities per chunk before aggressive culling
  max_entities_per_chunk: 50

  # Enable automatic entity cleanup (removes grounded arrows, items, etc.)
  auto_cleanup: true

  # Interval (in ticks) for entity cleanup routines
  cleanup_interval: 1200  # 1 minute

  # Maximum age (in ticks) for items before cleanup
  max_item_age: 6000  # 5 minutes

  # Maximum age (in ticks) for arrows before cleanup
  max_arrow_age: 1200  # 1 minute

# -----------------------------------------------------------------------------
# CLEANER FEATURES
# -----------------------------------------------------------------------------
cleaner:
  # Hostile Mob Auto-Cleaner
  hostile_mob_cleaner:
    enabled: true
    interval: 600  # ticks (30 seconds)
    broadcast: true  # Announce cleanups

  # Dropped Block & Item Cleaner
  dropped_item_cleaner:
    enabled: true
    interval: 1200  # ticks (1 minute)
    broadcast: true  # Announce cleanups
    exclude_valuable: true  # Don't remove diamonds, emeralds, etc.

  # Countdown before cleanup
  countdown:
    enabled: true
    format:
      10: "&6⚠ &eCleanup in &610s!"
      5: "&6⚠ &eCleanup in &65s!"
      4: "&6⚠ &eCleanup in &64s!"
      3: "&6⚠ &eCleanup in &c3s!"
      2: "&6⚠ &eCleanup in &c2s!"
      1: "&6⚠ &eCleanup in &c1s!"
      0: "&a✔ Cleanup completed!"

# -----------------------------------------------------------------------------
# EXPLOSION OPTIMIZATIONS
# -----------------------------------------------------------------------------
explosions:
  # Enable explosion optimizations
  enabled: true

  # Limit the number of blocks affected by explosions
  limit_blocks: true

  # Maximum blocks that can be affected by a single explosion
  max_blocks_affected: 100

  # Disable explosion particle effects for better performance
  disable_particles: true

  # Prevent fire damage from explosions
  disable_fire_damage: false

  # Maximum explosions per second (0 = unlimited)
  max_explosions_per_second: 5

  # TNT Optimization Settings
  tnt_optimization:
    enabled: true
    max_tnt_per_batch: 50
    power_scaling_factor: 1.0
    limit_block_updates: true
    safety_system:
      enabled: true
      show_messages: true

  # TNT Cannon Performance Stabilizer
  tnt_cannon_stabilizer:
    enabled: true
    async_simulations: true
    explosion_delay_ticks: 1  # Delay between queued explosions (1-5 recommended)
    max_explosions_per_tick: 10  # Maximum explosions processed per tick

  # TNT Fusion Optimization (New TNT Physics Mode)
  tnt_fusion:
    enabled: true
    fusion_radius: 3.0  # Radius to search for nearby TNT to fuse
    power_multiplier: 1.0  # Multiplier for fused explosion power
    enable_notifications: true  # Show fusion messages to ops/admins

# -----------------------------------------------------------------------------
# HOPPER OPTIMIZATIONS
# -----------------------------------------------------------------------------
hoppers:
  # Enable hopper transfer rate optimization
  optimize_transfer: true

  # Maximum items per hopper transfer tick
  max_transfer_rate: 8

  # Enable active hopper monitoring to reduce tick impact
  monitor_active_hoppers: true

  # Interval (in ticks) for hopper performance checks
  check_interval: 100

# -----------------------------------------------------------------------------
# FALLING BLOCK OPTIMIZATIONS
# -----------------------------------------------------------------------------
falling_blocks:
  # Enable optimized falling block physics (always enabled for efficiency)
  optimized_physics: true

  # Maximum falling blocks per chunk before limiting
  max_per_chunk: 20

  # Enable fast falling for optimized blocks
  fast_falling: true

# -----------------------------------------------------------------------------
# PERFORMANCE MONITORING
# -----------------------------------------------------------------------------
performance:
  # Target TPS for automatic optimizations
  target_tps: 20.0

  # Target MSPT (milliseconds per tick) for triggering optimizations
  target_mspt: 50.0

  # Interval (in ticks) for performance monitoring
  monitor_interval: 20  # 1 second

  # Enable automatic optimization triggers based on performance metrics
  auto_triggers: true

  # TPS threshold below which optimizations are automatically activated
  auto_trigger_tps_threshold: 18.0

  # MSPT threshold above which optimizations are automatically activated
  auto_trigger_mspt_threshold: 60.0

  # Enable dynamic mode for automatic performance booster
  auto_optimization: true

# -----------------------------------------------------------------------------
# ADMIN COMMANDS SETTINGS
# -----------------------------------------------------------------------------
commands:
  # Enable admin commands (requires permission: dynamicperformance.admin)
  enabled: true

  # Command prefix (default: /dp)
  prefix: "dp"

  # Enable performance statistics in /dp stats command
  show_detailed_stats: true

# -----------------------------------------------------------------------------
# DEBUG AND LOGGING
# -----------------------------------------------------------------------------
debug:
  # Enable debug logging for troubleshooting
  enabled: false

  # Log level: INFO, WARNING, ERROR, DEBUG
  log_level: "INFO"

  # Log optimization actions
  log_optimizations: false

# -----------------------------------------------------------------------------
# BOOST MODE SETTINGS
# -----------------------------------------------------------------------------
boost:
  # Duration (in seconds) for boost mode (30-60 recommended)
  duration: 30

  # Freeze AI of passive mobs during boost
  freeze_passive_ai: true

  # Slow down hopper transfer rates during boost
  slow_hoppers: true

  # Reduce redstone processing during boost
  reduce_redstone: true

  # Purge unused entities during boost
  purge_entities: true

  # Force garbage collection during boost
  clean_gc: true

# -----------------------------------------------------------------------------
# TIME DILATION MODE
# -----------------------------------------------------------------------------
time_dilation:
  enabled: true
  tps_threshold: 15.0
  slow_growth: true

  disable_mob_ai: true

# -----------------------------------------------------------------------------
# REDSTONE UPDATE LIMITER
# -----------------------------------------------------------------------------
redstone:
  update_limiter:
    enabled: true
    observer_activations_per_second: 100
    piston_events_per_second: 50
    block_updates_per_tick: 1000

# -----------------------------------------------------------------------------
# MOB FARM DENSITY CONTROLLER (under entities)
# -----------------------------------------------------------------------------
entities:
  # ... existing entities config ...
  mob_farm_controller:
    enabled: true
    max_mobs_per_radius: 10
    radius: 7
    action: "freeze_ai"  # freeze_ai, kill_extras, or disable_pathfinding
    disable_pathfinding: true

# ----------------------------------------------------------------------------
# AUTO-UNLOAD IDLE WORLDS
# ----------------------------------------------------------------------------
world_unload:
  enable: true
  check_interval_minutes: 5

# -----------------------------------------------------------------------------
# FARM OPTIMIZER
# -----------------------------------------------------------------------------
farm_optimizer:
  enabled: true
  mob_grinder_threshold: 10
  villager_breeder_threshold: 5
  crop_farm_threshold: 100
  sugarcane_threshold: 50
  bamboo_threshold: 50
  sorter_system_threshold: 20

# =============================================================================
# END OF CONFIGURATION
# =============================================================================